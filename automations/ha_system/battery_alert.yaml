#  _          _   _                       _         _   
# | |__  __ _| |_| |_ ___ _ _ _  _   __ _| |___ _ _| |_ 
# | '_ \/ _` |  _|  _/ -_) '_| || | / _` | / -_) '_|  _|
# |_.__/\__,_|\__|\__\___|_|  \_, | \__,_|_\___|_|  \__|
#                             |__/                      
#--FROM https://github.com/smcnab1/op-question-mark

alias: HA System Battery Alert
description: Automation which notifies me when batteries in sensor reach below 15%
use_blueprint:
  path: sbyx/low-battery-level-detection-notification-for-all-battery-sensors.yaml
  input:
    threshold: 15
    actions:
      - if:
          - condition: state
            entity_id: binary_sensor.mac_mini_active
            state: "on"
        then:
          - service: notify.mobile_app_ipad
            data:
              title: HA System - Battery Alert
              message: "Low battery warning for: {{sensors}}"
        else:
          - service: notify.mobile_app_iphone
            data:
              title: HA System - Battery Alert
              message: "Low battery warning for: {{sensors}}"
    exclude:
      entity_id:
        - sensor.iphone_battery_level
        - sensor.leah_s_iphone_battery_level
        - sensor.sams_macbook_air_ha_app_internal_battery_level
