---
### Card Generic - Waze ###
card_generic_waze:
  template:
    - "icon_more_info_new"
    - "ulm_translation_engine"
  variables:
    ulm_card_generic_icon: "[[[ return entity.attributes.icon ]]]"
    ulm_card_generic_name: "[[[ return entity.attributes.friendly_name ]]]"

  custom_fields:
    item1:
      card:
        type: "custom:button-card"
        custom_fields:
          item1:
            card:
              type: "custom:button-card"
              entity: "[[[ return entity.entity_id ]]]"
              icon: "[[[ return variables.ulm_card_generic_icon; ]]]"
              tap_action:
                action: "call-service"
                service: "automation.trigger"
                service_data:
                  entity_id: >-
                    {% if is_state('input_boolean.button_card_timer', 'on')%}
                    automation.waze_islington
                    {% elif is_state('input_boolean.button_card_timer', 'off')%}
                    automation.waze_camden
                    {% endif %}
              styles:
                icon: 
                  - color: >
                      [[[
                        if (states['input_boolean.button_card_timer'].state == 'on')
                          return "rgba(var(--color-blue), 1)";
                        else
                          return "rgba(var(--color-orange), 1)";
                        ]]]
                  - animation: > #### FIX COUNT DOWN VALUE
                      [[[
                        if (states['timer.button_card_timer_1min'].state <= '10')
                          return "blink 2s ease infinite";
                        ]]]
                img-cell: 
                  - background-color: >
                      [[[
                        if (states['input_boolean.button_card_timer'].state == 'on')
                          return "rgba(var(--color-blue), 0.2)";
                        else
                          return "rgba(var(--color-orange), 0.2)";
                        ]]]
                card:
                  - background-color: >
                      [[[
                        if (states['input_boolean.button_card_timer'].state == 'on')
                          return "rgba(var(--color-blue), 0.2)";
                        else
                          return "rgba(var(--color-orange), 0.2)";
                        ]]]

          item2:
            card:
              type: "custom:button-card"
              entity: "[[[ return entity.entity_id ]]]"
              tap_action:
                action: "call-service"
                service: "automation.trigger"
                service_data:
                  entity_id: "automation.citymapper_push"
              label: Waze Travel
              name: |
                [[[
                  if (states['input_boolean.button_card_timer'].state == 'on'){
                    return 'Islington Station';
                  } else {
                    return 'Camden Station';
                  }
                ]]]
