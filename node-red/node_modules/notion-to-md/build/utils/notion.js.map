{"version":3,"file":"notion.js","sourceRoot":"","sources":["../../src/utils/notion.ts"],"names":[],"mappings":";;;AAIO,MAAM,gBAAgB,GAAG,KAAK,EACnC,YAAoB,EACpB,QAAgB,EAChB,SAAwB,EACxB,EAAE;IACF,IAAI;QACF,IAAI,MAAM,GAAqC,EAAE,CAAC;QAClD,IAAI,SAAS,GAAG,CAAC,CAAC;QAClB,IAAI,YAAY,GAAG,SAAS,CAAC;QAE7B,GAAG;YACD,MAAM,QAAQ,GAAG,CAAC,MAAM,YAAY,CAAC,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC;gBACxD,YAAY,EAAE,YAAY;gBAC1B,QAAQ,EAAE,QAAQ;aACnB,CAAC,CAA8B,CAAC;YACjC,MAAM,CAAC,IAAI,CAAC,GAAG,QAAQ,CAAC,OAAO,CAAC,CAAC;YAEjC,YAAY,GAAG,QAAQ,aAAR,QAAQ,uBAAR,QAAQ,CAAE,WAAW,CAAC;YACrC,SAAS,IAAI,CAAC,CAAC;SAChB,QACC,YAAY,IAAI,IAAI;YACpB,CAAC,SAAS,IAAI,IAAI,IAAI,SAAS,GAAG,SAAS,CAAC,EAC5C;QAEF,IAAA,gCAAwB,EAAC,MAAM,CAAC,CAAC;QACjC,OAAO,MAAM,CAAC;KACf;IAAC,OAAO,CAAC,EAAE;QACV,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;QACf,OAAO,EAAE,CAAC;KACX;AACH,CAAC,CAAC;AA9BW,QAAA,gBAAgB,oBA8B3B;AAEK,MAAM,wBAAwB,GAAG,CACtC,MAAwC,EACxC,EAAE;IACF,IAAI,iBAAiB,GAAG,CAAC,CAAC;IAE1B,KAAK,MAAM,KAAK,IAAI,MAAM,EAAE;QAC1B,IAAI,MAAM,IAAI,KAAK,IAAI,KAAK,CAAC,IAAI,KAAK,oBAAoB,EAAE;YAC1D,cAAc;YACd,aAAa;YACb,KAAK,CAAC,kBAAkB,CAAC,MAAM,GAAG,EAAE,iBAAiB,CAAC;SACvD;aACI;YACH,iBAAiB,GAAG,CAAC,CAAC;SACvB;KACF;AACH,CAAC,CAAC;AAfW,QAAA,wBAAwB,4BAenC","sourcesContent":["import { Client } from \"@notionhq/client\";\r\nimport { ListBlockChildrenResponse } from \"@notionhq/client/build/src/api-endpoints\";\r\nimport { ListBlockChildrenResponseResults } from \"../types\";\r\n\r\nexport const getBlockChildren = async (\r\n  notionClient: Client,\r\n  block_id: string,\r\n  totalPage: number | null\r\n) => {\r\n  try {\r\n    let result: ListBlockChildrenResponseResults = [];\r\n    let pageCount = 0;\r\n    let start_cursor = undefined;\r\n\r\n    do {\r\n      const response = (await notionClient.blocks.children.list({\r\n        start_cursor: start_cursor,\r\n        block_id: block_id,\r\n      })) as ListBlockChildrenResponse;\r\n      result.push(...response.results);\r\n\r\n      start_cursor = response?.next_cursor;\r\n      pageCount += 1;\r\n    } while (\r\n      start_cursor != null &&\r\n      (totalPage == null || pageCount < totalPage)\r\n    );\r\n\r\n    modifyNumberedListObject(result);\r\n    return result;\r\n  } catch (e) {\r\n    console.log(e);\r\n    return [];\r\n  }\r\n};\r\n\r\nexport const modifyNumberedListObject = (\r\n  blocks: ListBlockChildrenResponseResults\r\n) => {\r\n  let numberedListIndex = 0;\r\n\r\n  for (const block of blocks) {\r\n    if (\"type\" in block && block.type === \"numbered_list_item\") {\r\n      // add numbers\r\n      // @ts-ignore\r\n      block.numbered_list_item.number = ++numberedListIndex;\r\n    }\r\n    else {\r\n      numberedListIndex = 0;\r\n    }\r\n  }\r\n};\r\n"]}